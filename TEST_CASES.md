# 프로젝트 테스트 케이스 문서

## 1. 개요

본 문서는 헬스온 Flutter 프로젝트의 핵심 기능에 대한 테스트 케이스를 정리한 문서입니다.
프로젝트의 주요 사용자 플로우를 중심으로 기능 검증 및 버그를 식별하기 위한 테스트 시나리오를 포함합니다.

**작성일**: 2025-12-15
**프로젝트**: 헬스온 (we)
**아키텍처**: Clean Architecture + MVVM (Provider)

---

## 2. 발견된 버그 요약

### 🔴 우선순위 1 (치명적)

#### 버그 #1: 로그인 화면 입력 검증 부재
- **위치**: `lib/presentation/organisms/auth/login_form.dart:70-71`
- **설명**: 아이디/비밀번호 입력 필드에 대한 검증이 없어 빈 값으로도 로그인 API 호출이 가능
- **영향**: 불필요한 API 호출, 서버 부하, 나쁜 UX
- **재현 방법**:
  1. 로그인 화면 접근
  2. 아이디/비밀번호를 입력하지 않고 "로그인" 버튼 클릭
  3. API 호출이 발생함 (예상: 클라이언트 검증으로 차단되어야 함)
- **수정 필요**: Form validator 추가 (회원가입과 동일한 패턴)

---

## 3. 테스트 케이스

### 3.1 인증 기능 (Authentication)

#### TC-AUTH-001: 로그인 - 정상 로그인
- **전제 조건**: 유효한 사용자 계정 존재 (아이디: `testuser`, 비밀번호: `Test1234!@`)
- **테스트 단계**:
  1. 로그인 화면 접근
  2. 아이디 입력: `testuser`
  3. 비밀번호 입력: `Test1234!@`
  4. "로그인" 버튼 클릭
- **예상 결과**:
  - 로그인 성공
  - 토큰이 SharedPreferences에 저장됨
  - 사용자 정보 로드 성공
  - 역할이 `ADMIN`이면 AdminScaffold로, 아니면 MainScaffold로 이동
- **버그 여부**: 없음

#### TC-AUTH-002: 로그인 - 빈 아이디 입력
- **전제 조건**: 로그인 화면 접근
- **테스트 단계**:
  1. 아이디 필드를 비워둠
  2. 비밀번호 입력: `Test1234!@`
  3. "로그인" 버튼 클릭
- **예상 결과**:
  - 클라이언트 측 검증으로 차단
  - "아이디를 입력해주세요." 에러 메시지 표시
  - API 호출 없음
- **버그 여부**: **발견됨 (버그 #1)** - 현재 검증 없이 API 호출됨

#### TC-AUTH-003: 로그인 - 빈 비밀번호 입력
- **전제 조건**: 로그인 화면 접근
- **테스트 단계**:
  1. 아이디 입력: `testuser`
  2. 비밀번호 필드를 비워둠
  3. "로그인" 버튼 클릭
- **예상 결과**:
  - 클라이언트 측 검증으로 차단
  - "비밀번호를 입력해주세요." 에러 메시지 표시
  - API 호출 없음
- **버그 여부**: **발견됨 (버그 #1)** - 현재 검증 없이 API 호출됨

#### TC-AUTH-004: 로그인 - 잘못된 인증 정보
- **전제 조건**: 로그인 화면 접근
- **테스트 단계**:
  1. 아이디 입력: `wronguser`
  2. 비밀번호 입력: `WrongPassword123!`
  3. "로그인" 버튼 클릭
- **예상 결과**:
  - 로그인 실패
  - 서버에서 반환된 에러 메시지 표시
  - 로그인 화면 유지
- **버그 여부**: 없음 (서버 검증)

#### TC-AUTH-005: 로그인 - 로딩 상태 표시
- **전제 조건**: 로그인 화면 접근
- **테스트 단계**:
  1. 유효한 아이디/비밀번호 입력
  2. "로그인" 버튼 클릭
  3. API 응답 대기 중 UI 확인
- **예상 결과**:
  - "로그인" 버튼이 로딩 상태로 변경
  - 사용자가 중복 클릭할 수 없음
  - 로딩 완료 후 정상 동작
- **버그 여부**: 없음

#### TC-AUTH-006: 회원가입 - 정상 회원가입
- **전제 조건**: 회원가입 화면 접근
- **테스트 단계**:
  1. 아이디 입력: `newuser`
  2. 비밀번호 입력: `Test1234!@`
  3. 비밀번호 확인 입력: `Test1234!@`
  4. 이름 입력: `홍길동`
  5. 전화번호 입력: `01012345678`
  6. 추천인 코드 입력: (선택) `REFER123`
  7. "가입하기" 버튼 클릭
- **예상 결과**:
  - 회원가입 성공
  - "회원가입이 완료되었습니다." 토스트 메시지 표시
  - 로그인 화면으로 자동 이동
- **버그 여부**: 없음

#### TC-AUTH-007: 회원가입 - 필수 필드 누락
- **전제 조건**: 회원가입 화면 접근
- **테스트 단계**:
  1. 아이디만 입력: `newuser`
  2. 다른 필드는 비워둠
  3. "가입하기" 버튼 클릭
- **예상 결과**:
  - Form validation 실패
  - 각 필드 아래 에러 메시지 표시:
    - "비밀번호를 입력해주세요."
    - "이름을 입력해주세요."
    - "전화번호를 입력해주세요."
  - API 호출 없음
- **버그 여부**: 없음

#### TC-AUTH-008: 회원가입 - 비밀번호 규칙 위반
- **전제 조건**: 회원가입 화면 접근
- **테스트 단계**:
  1. 아이디 입력: `newuser`
  2. 비밀번호 입력: `weak` (규칙 위반)
  3. 비밀번호 확인 입력: `weak`
  4. 이름 입력: `홍길동`
  5. 전화번호 입력: `01012345678`
  6. "가입하기" 버튼 클릭
- **예상 결과**:
  - Form validation 실패
  - 비밀번호 필드 아래 에러 메시지 표시:
    - "비밀번호는 8~20자이며, 영문 대/소문자, 숫자, 특수문자를 포함해야 합니다."
  - API 호출 없음
- **버그 여부**: 없음

#### TC-AUTH-009: 회원가입 - 비밀번호 불일치
- **전제 조건**: 회원가입 화면 접근
- **테스트 단계**:
  1. 아이디 입력: `newuser`
  2. 비밀번호 입력: `Test1234!@`
  3. 비밀번호 확인 입력: `Different1234!@`
  4. 이름 입력: `홍길동`
  5. 전화번호 입력: `01012345678`
  6. "가입하기" 버튼 클릭
- **예상 결과**:
  - Form validation 실패
  - 비밀번호 확인 필드 아래 에러 메시지 표시:
    - "비밀번호가 일치하지 않습니다."
  - API 호출 없음
- **버그 여부**: 없음

#### TC-AUTH-010: 회원가입 - 추천인 코드 선택 사항 확인
- **전제 조건**: 회원가입 화면 접근
- **테스트 단계**:
  1. 모든 필수 필드 입력 (아이디, 비밀번호, 이름, 전화번호)
  2. 추천인 코드는 비워둠
  3. "가입하기" 버튼 클릭
- **예상 결과**:
  - 회원가입 성공 (추천인 코드 없이도 가능)
  - 로그인 화면으로 이동
- **버그 여부**: 없음

---

### 3.2 라우팅 및 권한 (Routing & Authorization)

#### TC-ROUTE-001: 미인증 사용자의 보호된 페이지 접근
- **전제 조건**: 로그아웃 상태 (토큰 없음)
- **테스트 단계**:
  1. 브라우저/앱에서 보호된 라우트로 직접 접근 시도 (예: `/product-list`)
  2. 라우팅 동작 확인
- **예상 결과**:
  - 자동으로 로그인 화면(`/login`)으로 리다이렉트
  - 보호된 페이지에 접근 불가
- **버그 여부**: 없음
- **참고**: `main.dart:42-44`에서 토큰 체크 로직 구현됨

#### TC-ROUTE-002: 인증된 사용자가 로그인 화면 접근
- **전제 조건**: 로그인 상태 (유효한 토큰 존재)
- **테스트 단계**:
  1. 로그인 완료 후
  2. `/login` 라우트로 직접 접근 시도
- **예상 결과**:
  - LoginScreen의 initState에서 토큰 확인
  - 자동으로 MainScaffold로 리다이렉트
  - 로그인 화면이 표시되지 않음
- **버그 여부**: 없음
- **참고**: `login_screen.dart:32-36`에서 구현됨

#### TC-ROUTE-003: 관리자 역할 사용자 라우팅
- **전제 조건**: 관리자 계정으로 로그인 (role: `ADMIN`)
- **테스트 단계**:
  1. 관리자 계정으로 로그인
  2. 로그인 성공 후 이동 화면 확인
- **예상 결과**:
  - AdminScaffold로 이동
  - 관리자 전용 메뉴 표시 (제품 관리, 주문 관리, 사용자 관리 등)
- **버그 여부**: 없음
- **참고**: `login_screen.dart:63-67`에서 역할별 라우팅 구현됨

#### TC-ROUTE-004: 일반 사용자 역할 라우팅
- **전제 조건**: 일반 사용자 계정으로 로그인 (role: `USER`)
- **테스트 단계**:
  1. 일반 사용자 계정으로 로그인
  2. 로그인 성공 후 이동 화면 확인
- **예상 결과**:
  - MainScaffold로 이동
  - 일반 사용자 메뉴 표시 (홈, 제품 목록, 추천, 마이페이지)
- **버그 여부**: 없음

#### TC-ROUTE-005: 앱 최초 실행 시 초기 라우트
- **전제 조건**: 앱 최초 실행 (토큰 없음)
- **테스트 단계**:
  1. 앱 실행
  2. 초기 화면 확인
- **예상 결과**:
  - 로그인 화면(`/login`)이 표시됨
- **버그 여부**: 없음
- **참고**: `main.dart:26-28`에서 initialRoute 설정

#### TC-ROUTE-006: 토큰 존재 시 앱 실행
- **전제 조건**: 이전에 로그인한 적 있음 (토큰 저장됨)
- **테스트 단계**:
  1. 앱 재실행
  2. 초기 화면 확인
- **예상 결과**:
  - MainScaffold로 바로 이동 (로그인 화면 건너뜀)
  - 사용자 세션 유지
- **버그 여부**: 없음

---

### 3.3 제품 구매 플로우 (Product Purchase Flow)

#### TC-PRODUCT-001: 제품 목록 조회
- **전제 조건**: 로그인 상태
- **테스트 단계**:
  1. MainScaffold에서 "제품 목록" 탭 클릭
  2. 제품 목록 화면 확인
- **예상 결과**:
  - 제품 목록이 표시됨
  - 각 제품의 이름, 가격, 이미지 표시
  - 페이징 기능 동작
- **버그 여부**: 없음

#### TC-PRODUCT-002: 제품 상세 조회
- **전제 조건**: 로그인 상태, 제품 목록 화면
- **테스트 단계**:
  1. 제품 목록에서 특정 제품 클릭
  2. 제품 상세 화면 확인
- **예상 결과**:
  - 제품 상세 정보 표시 (이름, 가격, 재고, 이미지, 설명)
  - "구매하기" 버튼 표시
  - 재고가 0이면 버튼 비활성화
- **버그 여부**: 없음

#### TC-PRODUCT-003: 제품 구매 - 정상 구매
- **전제 조건**: 로그인 상태, 충분한 포인트 보유, 재고 있는 제품 선택
- **테스트 단계**:
  1. 제품 상세 화면에서 "구매하기" 버튼 클릭
  2. 구매 확인 모달에서 정보 확인
  3. "확인" 버튼 클릭
- **예상 결과**:
  - 구매 성공
  - "구매가 완료되었습니다!" 토스트 메시지 표시
  - 사용자 포인트 차감
  - 사용자 정보 자동 갱신
- **버그 여부**: 없음
- **참고**: `product_detail_screen.dart:119-147`에서 구매 로직 구현

#### TC-PRODUCT-004: 제품 구매 - 재고 부족
- **전제 조건**: 로그인 상태, 재고가 0인 제품 선택
- **테스트 단계**:
  1. 재고가 0인 제품 상세 화면 확인
  2. "구매하기" 버튼 상태 확인
- **예상 결과**:
  - "구매하기" 버튼 비활성화 (onPressed: null)
  - 사용자가 구매할 수 없음
- **버그 여부**: 없음
- **참고**: `product_detail_screen.dart:112-113`에서 재고 체크

#### TC-PRODUCT-005: 제품 구매 - 포인트 부족
- **전제 조건**: 로그인 상태, 포인트가 제품 가격보다 적음
- **테스트 단계**:
  1. 제품 상세 화면에서 "구매하기" 버튼 클릭
  2. 구매 시도
- **예상 결과**:
  - 서버에서 포인트 부족 에러 반환
  - 에러 메시지 토스트로 표시
  - 구매 실패
- **버그 여부**: 없음 (서버 검증)

#### TC-PRODUCT-006: 제품 구매 - 구매 후 포인트 표시
- **전제 조건**: 로그인 상태, 제품 상세 화면
- **테스트 단계**:
  1. 구매 확인 모달에서 "구매 후 포인트" 확인
  2. 현재 포인트와 제품 가격 차이 계산
- **예상 결과**:
  - 구매 후 포인트 = 현재 포인트 - 제품 가격
  - 정확한 계산 결과 표시
- **버그 여부**: 없음
- **참고**: `product_detail_screen.dart:72-74`에서 계산

---

### 3.4 포인트 기능 (Points)

#### TC-POINT-001: 포인트 충전
- **전제 조건**: 로그인 상태, 포인트 관리 화면 접근
- **테스트 단계**:
  1. 포인트 요약 카드에서 "충전" 버튼 클릭
  2. 충전 금액 입력 (예: 10000)
  3. "확인" 버튼 클릭
- **예상 결과**:
  - 포인트 충전 성공
  - "포인트 충전이 완료되었습니다!" 토스트 메시지 표시
  - 포인트 내역 자동 갱신
  - 현재 포인트 증가
- **버그 여부**: 없음
- **참고**: `point_management_screen.dart:106-128`에서 충전 로직 구현

#### TC-POINT-002: 포인트 내역 조회 - 충전 탭
- **전제 조건**: 로그인 상태, 포인트 관리 화면
- **테스트 단계**:
  1. "충전" 탭 선택
  2. 포인트 충전 내역 확인
- **예상 결과**:
  - 충전 내역만 필터링되어 표시 (type: 'CHARGE')
  - 각 내역의 금액, 날짜, 잔액 표시
  - 금액은 "+{amount} P" 형식
- **버그 여부**: 없음

#### TC-POINT-003: 포인트 내역 조회 - 사용 탭
- **전제 조건**: 로그인 상태, 포인트 관리 화면
- **테스트 단계**:
  1. "사용" 탭 선택
  2. 포인트 사용 내역 확인
- **예상 결과**:
  - 사용 내역만 필터링되어 표시 (type: 'USE')
  - 각 내역의 금액, 날짜, 잔액 표시
  - 금액은 "-{amount} P" 형식
- **버그 여부**: 없음

#### TC-POINT-004: 포인트 내역 조회 - 수당 탭
- **전제 조건**: 로그인 상태, 포인트 관리 화면
- **테스트 단계**:
  1. "수당" 탭 선택
  2. 포인트 수당 내역 확인
- **예상 결과**:
  - 수당 내역만 필터링되어 표시 (type: 'COMMISSION')
  - 각 내역의 금액, 날짜, 잔액 표시
  - 금액은 "+{amount} P" 형식
- **버그 여부**: 없음

#### TC-POINT-005: 현재 포인트 표시
- **전제 조건**: 로그인 상태, 포인트 관리 화면
- **테스트 단계**:
  1. 포인트 관리 화면 진입
  2. 포인트 요약 카드 확인
- **예상 결과**:
  - 현재 보유 포인트 정확히 표시
  - "{포인트} P" 형식
- **버그 여부**: 없음

---

### 3.5 사용자 정보 관리 (User)

#### TC-USER-001: 사용자 정보 조회
- **전제 조건**: 로그인 상태
- **테스트 단계**:
  1. MainScaffold에서 "마이페이지" 탭 클릭
  2. 사용자 정보 확인
- **예상 결과**:
  - 사용자 이름, 아이디, 전화번호, 포인트, 등급 등 표시
  - 정확한 정보 표시
- **버그 여부**: 없음

#### TC-USER-002: 사용자 정보 수정
- **전제 조건**: 로그인 상태, 마이페이지
- **테스트 단계**:
  1. "정보 수정" 버튼 클릭
  2. 전화번호 변경
  3. "저장" 버튼 클릭
- **예상 결과**:
  - 정보 수정 성공
  - 성공 메시지 표시
  - 변경된 정보 즉시 반영
- **버그 여부**: 없음 (구현 상태 확인 필요)

#### TC-USER-003: 구매 이력 조회
- **전제 조건**: 로그인 상태, 이전 구매 기록 존재
- **테스트 단계**:
  1. 마이페이지에서 "구매 이력" 메뉴 클릭
  2. 구매 이력 화면 확인
- **예상 결과**:
  - 과거 구매한 제품 목록 표시
  - 각 구매의 제품명, 가격, 날짜, 상태 표시
- **버그 여부**: 없음 (구현 상태 확인 필요)

#### TC-USER-004: 로그아웃
- **전제 조건**: 로그인 상태
- **테스트 단계**:
  1. 마이페이지에서 "로그아웃" 버튼 클릭
  2. 로그아웃 확인
- **예상 결과**:
  - 토큰이 삭제됨
  - 로그인 화면으로 이동
  - 보호된 페이지 접근 불가
- **버그 여부**: 없음 (구현 상태 확인 필요)

---

## 4. 우선순위별 버그 및 개선 사항

### 우선순위 1 (즉시 수정 필요)

| 번호 | 버그 설명 | 위치 | 영향도 | 관련 테스트 케이스 |
|------|-----------|------|--------|-------------------|
| #1 | 로그인 입력 검증 부재 | `lib/presentation/organisms/auth/login_form.dart` | 높음 | TC-AUTH-002, TC-AUTH-003 |

### 우선순위 2 (권장 개선)

- 현재 발견된 버그 없음

---

## 5. 테스트 실행 권장사항

### 5.1 수동 테스트 순서
1. **인증 기능 테스트** (TC-AUTH-001 ~ TC-AUTH-010)
2. **라우팅 및 권한 테스트** (TC-ROUTE-001 ~ TC-ROUTE-006)
3. **제품 구매 플로우 테스트** (TC-PRODUCT-001 ~ TC-PRODUCT-006)
4. **포인트 기능 테스트** (TC-POINT-001 ~ TC-POINT-005)
5. **사용자 정보 관리 테스트** (TC-USER-001 ~ TC-USER-004)

### 5.2 회귀 테스트 대상
버그 수정 후 다음 테스트 케이스를 재검증하세요:
- TC-AUTH-002: 로그인 - 빈 아이디 입력
- TC-AUTH-003: 로그인 - 빈 비밀번호 입력

### 5.3 테스트 환경
- **Flutter 버전**: (프로젝트 pubspec.yaml 참조)
- **테스트 서버**: `http://healthon.store:81`
- **필요한 테스트 계정**:
  - 일반 사용자 계정 1개
  - 관리자 계정 1개
  - 충분한 포인트 보유 계정 1개
  - 포인트 부족 계정 1개

---

## 6. 참고 사항

### 주요 파일 위치
- 인증: `lib/presentation/screens/auth/`, `lib/presentation/organisms/auth/`
- 라우팅: `lib/main.dart`, `lib/core/routes/app_routes.dart`
- 제품: `lib/presentation/screens/product/`
- 포인트: `lib/presentation/screens/points/`
- 사용자: `lib/presentation/screens/user/`

### 아키텍처 구조
```
Presentation Layer (UI)
    ↓
ViewModel (Provider)
    ↓
UseCase (Business Logic)
    ↓
Repository Interface
    ↓
Repository Implementation
    ↓
API (HTTP Client)
```

---

**문서 버전**: 1.0
**마지막 업데이트**: 2025-12-15
